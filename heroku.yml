build:
  docker:
    api:
      dockerfile: docker/api/Dockerfile
      context: FastAPI
    worker:
      dockerfile: docker/worker/Dockerfile
      context: FastAPI
    beat:
      dockerfile: docker/worker/Dockerfile
      context: FastAPI
    web:
      dockerfile: fantasy-app/Dockerfile
      context: fantasy-app

run:
  api: uvicorn main:app --host 0.0.0.0 --port $PORT
  worker: celery -A services.scrape_worker worker --loglevel=info
  beat: celery -A services.scrape_worker beat --loglevel=info
  web: npm start

setup:
  addons:
    - plan: heroku-redis:hobby-dev
  config:
    MONGODB_URL: ${MONGODB_URL}