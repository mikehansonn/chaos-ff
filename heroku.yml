build:
  docker:
    web: fantasy-app/Dockerfile
    api: docker/api/Dockerfile  
    worker: docker/worker/Dockerfile
    beat: docker/worker/Dockerfile

run:
  web: cd fantasy-app && npm install && npm run build && npm run start:prod
  api: cd FastAPI && uvicorn main:app --host 0.0.0.0 --port $PORT
  worker: cd FastAPI && celery -A services.scrape_worker worker --loglevel=info
  beat: cd FastAPI && celery -A services.scrape_worker beat --loglevel=info

setup:
  addons:
    - plan: heroku-redis:hobby-dev
  config:
    MONGODB_URL: ${MONGODB_URL}